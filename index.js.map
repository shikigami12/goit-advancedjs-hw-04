{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n/**\n * Configuration for Pixabay API requests\n */\nclass RequestConfig {\n  /**\n   * Creates a new request configuration with default parameters\n   */\n  constructor() {\n    this.params = {\n      key: '',\n      q: '',\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    };\n  }\n\n  /**\n   * Sets the API key for authentication\n   * @param {string} apiKey - Pixabay API key\n   */\n  setApiKey(apiKey) {\n    this.params.key = apiKey;\n  }\n\n  /**\n   * Sets the search query\n   * @param {string} query - Search term\n   */\n  setQuery(query) {\n    this.params.q = query;\n  }\n}\n\n/**\n * Client for interacting with Pixabay API\n */\nclass PixabayApi {\n  /**\n   * Creates a new Pixabay API client\n   * @param {string} apiKey - Pixabay API key\n   */\n  constructor(apiKey) {\n    this.apiKey = apiKey;\n    axios.defaults.baseURL = 'https://pixabay.com/api/';\n  }\n\n  /**\n   * Fetches images matching the provided query\n   * @param {string} query - Search term\n   * @returns {Promise<Array>} - Promise resolving to array of image objects\n   */\n  fetchImages(query) {\n    const config = new RequestConfig();\n    config.setApiKey(this.apiKey);\n    config.setQuery(query);\n\n    return this._get('', { params: config.params });\n  }\n\n  /**\n   * Makes a GET request to the API\n   * @param {string} url - API endpoint\n   * @param {Object} config - Request configuration\n   * @returns {Promise<Object>} - Promise resolving to API response data\n   * @private\n   */\n  _get(url, config) {\n    return axios.get(url, config)\n      .then(response => response.data.hits || response.data)\n      .catch(error => this._onError(error, url, config));\n  }\n\n  /**\n   * Handles API errors with rate limit retry logic\n   * @param error - Error object from axios\n   * @param {string} url - Original request URL\n   * @param {Object} config - Original request configuration\n   * @returns {Promise<Object>} - Promise that may retry the request\n   * @private\n   */\n  _onError(error, url, config) {\n    if (error.status === 429) {\n      const retryAfter = error.response.headers['x-ratelimit-reset'] ||\n        error.response.headers['X-RateLimit-Reset'] ||\n        60;\n      console.warn(`Rate limit exceeded. Retrying after ${retryAfter} seconds...`);\n\n      return new Promise((resolve) => {\n        setTimeout(() => {\n          resolve(this._get(url, config));\n        }, retryAfter * 1000);\n      });\n    } else {\n      console.error('Error fetching images:', error);\n      throw error;\n    }\n  }\n}\n\nexport { PixabayApi, RequestConfig };","/**\n * Class representing a Pixabay image hit response.\n */\nclass PixabayImage {\n  /**\n   * Create a PixabayImage.\n   * @param {Object} data - The image data.\n   * @param {number} data.id - The image ID.\n   * @param {string} data.type - The type of the image.\n   * @param {string} data.tags - The tags associated with the image.\n   * @param {string} data.webformatURL - The URL of the web format image.\n   * @param {string} data.largeImageURL - The URL of the original image.\n   * @param {number} data.views - The number of views.\n   * @param {number} data.downloads - The number of downloads.\n   * @param {number} data.likes - The number of likes.\n   * @param {number} data.comments - The number of comments.\n   * @param {string} data.user - The username of the user who uploaded the image.\n   */\n  constructor(data) {\n    this.id = data.id;\n    this.type = data.type;\n    this.tags = data.tags;\n    this.webformatURL = data.webformatURL;\n    this.imageURL = data.largeImageURL;\n    this.views = data.views;\n    this.downloads = data.downloads;\n    this.likes = data.likes;\n    this.comments = data.comments;\n    this.user = data.user;\n  }\n}\n\n/**\n * Class for rendering an image.\n */\nclass ImageRenderer {\n  constructor() {\n    this._imageElement = document.createElement('img');\n  }\n\n  /**\n   * Sets the image source and alt text.\n   * @param {PixabayImage} image - The image to render.\n   */\n  setImage(image) {\n    this._imageElement.src = image.webformatURL;\n    this._imageElement.alt = image.tags;\n    this._imageElement.width = 360;\n    this._imageElement.height = 200;\n    this._imageElement.title = image.tags;\n    this._imageElement.setAttribute('data-id', image.id.toString());\n    this._imageElement.setAttribute('data-user', image.user);\n  }\n\n  /**\n   * Renders the image element.\n   * @returns {HTMLImageElement} - The image element.\n   */\n  render() {\n    return this._imageElement;\n  }\n}\n\n/**\n * Class for rendering a gallery of images.\n */\nclass GalleryRenderer {\n  /**\n   * Creates a new GalleryRenderer.\n   * @param {string} gallerySelector - The CSS class for the gallery.\n   * @param {Element} parentElement - The parent element to append the gallery to.\n   */\n  constructor(gallerySelector, parentElement) {\n    this._parentElement = parentElement;\n    if (!this._parentElement) {\n      throw new Error(`Parent element ${parentElement} not found`);\n    }\n\n    // if parent element already has a child with the same class, use that\n    const existingGallery = this._parentElement.querySelector(`.${gallerySelector}`);\n    if (existingGallery) {\n      this._galleryElement = existingGallery;\n      return;\n    }\n\n    // create a new gallery element\n    this._galleryElement = document.createElement('ul');\n    this._galleryElement.classList.add(gallerySelector);\n  }\n\n  /**\n   * Adds an image to the gallery.\n   * @param {PixabayImage} image - The image to add.\n   */\n  addImage(image) {\n    const imageRenderer = new ImageRenderer();\n    imageRenderer.setImage(image);\n    const listItem = document.createElement('li');\n    const link = document.createElement('a');\n    link.href = image.imageURL;\n    link.append(imageRenderer.render());\n    link.append(this._generateDescription(image));\n    listItem.appendChild(link);\n    this._galleryElement.appendChild(listItem);\n  }\n\n  /**\n   * Generates a description table for the image.\n   * @param {PixabayImage} image - The image to describe.\n   * @returns {HTMLTableElement} - The description table.\n   * @private\n   */\n  _generateDescription(image) {\n    const headers = ['Likes', 'Views', 'Comments', 'Downloads'];\n    const table = document.createElement('table');\n    const headerRow = document.createElement('tr');\n    headers.forEach(header => {\n      const th = document.createElement('th');\n      th.textContent = header;\n      headerRow.appendChild(th);\n    });\n    table.appendChild(headerRow);\n    const valuesRow = document.createElement('tr');\n    const values = [\n      image.likes,\n      image.views,\n      image.comments,\n      image.downloads,\n    ];\n    values.forEach(value => {\n      const td = document.createElement('td');\n      td.textContent = `${value}`;\n      valuesRow.appendChild(td);\n    });\n    table.appendChild(valuesRow);\n    return table;\n  }\n\n  /**\n   * Renders the gallery.\n   */\n  render() {\n    if (!this._parentElement) {\n      throw new Error(`Parent element ${this._parentElement} not found`);\n    }\n\n    this._parentElement.appendChild(this._galleryElement);\n  }\n\n  /**\n   * Clears the gallery.\n   */\n  clear() {\n    this._galleryElement.innerHTML = '';\n    this._parentElement.innerHTML = '';\n  }\n}\n\nexport { GalleryRenderer, PixabayImage, ImageRenderer };","import { PixabayApi } from './js/pixabay-api.js';\nimport { GalleryRenderer, PixabayImage } from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nclass ImageSearch {\n  constructor() {\n    this._searchForm = document.querySelector('form.search-form');\n    this._galleryElement = document.querySelector('.gallery');\n    this._galleryRenderer = new GalleryRenderer('gallery', this._galleryElement);\n    this._pixabayApi = new PixabayApi('49652038-e061cdaf0adfcf3d7bc5fddbb');\n    this._lightbox = new SimpleLightbox('div.gallery ul.gallery li a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    this._loader = document.querySelector('.loader');\n  }\n\n  /**\n   * Initializes the search form event listeners.\n   */\n  init() {\n    this._searchForm.addEventListener('submit', (event) => {\n      event.preventDefault();\n      const query = event.target.querySelector('input[name=\"searchQuery\"]').value;\n      if (!query) {\n        iziToast.error({\n          message: 'Please enter a search term.',\n        });\n        return;\n      }\n      this._onSearch(query);\n    });\n  }\n\n  /**\n   * Handles the search event.\n   * @param {string} query - The search query.\n   */\n  _onSearch(query) {\n    this._galleryRenderer.clear();\n    this._searchForm.reset();\n    this._toggleLoader();\n    this._pixabayApi.fetchImages(query).then(images => {\n      this._toggleLoader();\n      if (images.length === 0) {\n        iziToast.show({\n          color: '#EF4040',\n          icon: 'icon-close',\n          title: 'âŒ',\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n        });\n        return;\n      }\n      images.forEach(image => {\n        this._galleryRenderer.addImage(new PixabayImage(image));\n      });\n\n      this._galleryRenderer.render();\n      this._lightbox.refresh();\n    });\n  }\n\n  /**\n   * Toggles the loader visibility.\n   */\n  _toggleLoader() {\n    this._loader.classList.toggle('show');\n  }\n}\n\nnew ImageSearch().init();"],"names":["RequestConfig","apiKey","query","PixabayApi","axios","config","url","response","error","retryAfter","resolve","PixabayImage","data","ImageRenderer","image","GalleryRenderer","gallerySelector","parentElement","existingGallery","imageRenderer","listItem","link","headers","table","headerRow","header","th","valuesRow","value","td","ImageSearch","SimpleLightbox","event","iziToast","images"],"mappings":"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"}