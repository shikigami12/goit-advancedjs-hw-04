import{a as h,S as m,i as c}from"./assets/vendor-DVva8SYe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}})();class d{constructor(){this.params={key:"",q:"",image_type:"photo",orientation:"horizontal",safesearch:!0,per_page:15,page:1}}setApiKey(e){this.params.key=e}setQuery(e){this.params.q=e}setPage(e){this.params.page=e}}class u{constructor(e){this.hits=e.hits,this.total=e.total,this.totalHits=e.totalHits}}class g{constructor(e){this.apiKey=e,h.defaults.baseURL="https://pixabay.com/api/"}async fetchImages(e,r=1){const s=new d;s.setApiKey(this.apiKey),s.setQuery(e),s.setPage(r);const t=await this._get("",s);return new u(t)}_get(e,r){return h.get(e,r).then(s=>s.data).catch(s=>this._onError(s,e,r))}_onError(e,r,s){if(e.status===429){const t=e.response.headers["x-ratelimit-reset"]||e.response.headers["X-RateLimit-Reset"]||60;return console.warn(`Rate limit exceeded. Retrying after ${t} seconds...`),new Promise(n=>{setTimeout(()=>{n(this._get(r,s))},t*1e3)})}else throw console.error("Error fetching images:",e),e}}class p{constructor(e){this.id=e.id,this.type=e.type,this.tags=e.tags,this.webformatURL=e.webformatURL,this.imageURL=e.largeImageURL,this.views=e.views,this.downloads=e.downloads,this.likes=e.likes,this.comments=e.comments,this.user=e.user}}class _{constructor(){this._imageElement=document.createElement("img")}setImage(e){this._imageElement.src=e.webformatURL,this._imageElement.alt=e.tags,this._imageElement.width=360,this._imageElement.height=200,this._imageElement.title=e.tags,this._imageElement.setAttribute("data-id",e.id.toString()),this._imageElement.setAttribute("data-user",e.user)}render(){return this._imageElement}}class y{constructor(e,r){if(this._parentElement=r,!this._parentElement)throw new Error(`Parent element ${r} not found`);const s=this._parentElement.querySelector(`.${e}`);if(s){this._galleryElement=s;return}this._galleryElement=document.createElement("ul"),this._galleryElement.classList.add(e),this._moreButton=null}appendImages(e){const r=e.map(s=>this._generateListItem(new p(s)));this._galleryElement.append(...r)}addMoreButton(e,r,s){this._parentElement.contains(this._moreButton)&&this._parentElement.removeChild(this._moreButton),r>0&&r>e*15?(this._moreButton=document.createElement("button"),this._moreButton.textContent="Load more",this._moreButton.classList.add("load-more"),this._moreButton.addEventListener("click",s)):(this._moreButton=document.createElement("p"),this._moreButton.textContent="We're sorry, but you've reached the end of search results.",this._moreButton.classList.add("no-more"))}_generateListItem(e){const r=new _;r.setImage(e);const s=document.createElement("li"),t=document.createElement("a");return t.href=e.imageURL,t.append(r.render()),t.append(this._generateDescription(e)),s.appendChild(t),s}_generateDescription(e){const r=["Likes","Views","Comments","Downloads"],s=document.createElement("table"),t=document.createElement("tr");r.forEach(l=>{const o=document.createElement("th");o.textContent=l,t.appendChild(o)}),s.appendChild(t);const n=document.createElement("tr");return[e.likes,e.views,e.comments,e.downloads].forEach(l=>{const o=document.createElement("td");o.textContent=`${l}`,n.appendChild(o)}),s.appendChild(n),s}render(){if(!this._parentElement)throw new Error(`Parent element ${this._parentElement} not found`);this._parentElement.contains(this._galleryElement)||this._parentElement.appendChild(this._galleryElement),this._moreButton&&this._parentElement.appendChild(this._moreButton)}clear(){this._galleryElement.innerHTML="",this._parentElement.innerHTML=""}}class f{constructor(){this._searchForm=document.querySelector("form.search-form"),this._galleryElement=document.querySelector(".gallery"),this._galleryRenderer=new y("gallery",this._galleryElement),this._pixabayApi=new g("49652038-e061cdaf0adfcf3d7bc5fddbb"),this._lightbox=new m("div.gallery ul.gallery li a",{captionsData:"alt",captionDelay:250}),this._page=1,this._loader=document.querySelector(".loader"),this._query=null}async init(){this._searchForm.addEventListener("submit",async e=>{e.preventDefault();const r=e.target.querySelector('input[name="searchQuery"]').value;if(!r){c.error({message:"Please enter a search term."});return}this._query=r,this._resetPaging(),this._searchForm.reset(),this._galleryRenderer.clear(),await this._onSearch()})}_resetPaging(){this._page=1}async _onSearch(){this._toggleLoader();const e=await this._pixabayApi.fetchImages(this._query,this._page);if(this._toggleLoader(),!e.hits||!e.hits.length){c.show({color:"#EF4040",icon:"icon-close",title:"❌",message:"Sorry, there are no images matching your search query. Please try again!"});return}this._galleryRenderer.appendImages(e.hits),this._galleryRenderer.addMoreButton(this._page,e.totalHits,this._loadMore.bind(this)),this._galleryRenderer.render(),this._lightbox.refresh()}_scrollByOneRow(){const e=document.querySelector("ul.gallery li");if(e){const r=e.offsetHeight+e.offsetHeight;window.scrollBy({top:r,behavior:"smooth"})}}async _loadMore(){this._page++,await this._onSearch(this._query),this._scrollByOneRow()}_toggleLoader(){this._loader.classList.toggle("show")}}const E=new f;E.init().catch(i=>{console.error(i)});
//# sourceMappingURL=index.js.map
