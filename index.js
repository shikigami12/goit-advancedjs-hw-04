import{a as c,S as m,i as h}from"./assets/vendor-DVva8SYe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();class d{constructor(){this.params={key:"",q:"",image_type:"photo",orientation:"horizontal",safesearch:!0,per_page:15,page:1}}setApiKey(e){this.params.key=e}setQuery(e){this.params.q=e}setPage(e){this.params.page=e}}class u{constructor(e){this.hits=e.hits,this.total=e.total,this.totalHits=e.totalHits}}class g{constructor(e){this.apiKey=e,c.defaults.baseURL="https://pixabay.com/api/"}async fetchImages(e,s=1){const r=new d;r.setApiKey(this.apiKey),r.setQuery(e),r.setPage(s);const t=await this._get("",r);return new u(t)}_get(e,s){return c.get(e,s).then(r=>r.data).catch(r=>this._onError(r,e,s))}_onError(e,s,r){if(e.status===429){const t=e.response.headers["x-ratelimit-reset"]||e.response.headers["X-RateLimit-Reset"]||60;return console.warn(`Rate limit exceeded. Retrying after ${t} seconds...`),new Promise(i=>{setTimeout(()=>{i(this._get(s,r))},t*1e3)})}else throw console.error("Error fetching images:",e),e}}class p{constructor(e){this.id=e.id,this.type=e.type,this.tags=e.tags,this.webformatURL=e.webformatURL,this.imageURL=e.largeImageURL,this.views=e.views,this.downloads=e.downloads,this.likes=e.likes,this.comments=e.comments,this.user=e.user}}class _{constructor(){this._imageElement=document.createElement("img")}setImage(e){this._imageElement.src=e.webformatURL,this._imageElement.alt=e.tags,this._imageElement.width=360,this._imageElement.height=200,this._imageElement.title=e.tags,this._imageElement.setAttribute("data-id",e.id.toString()),this._imageElement.setAttribute("data-user",e.user)}render(){return this._imageElement}}class y{constructor(e,s){if(this._parentElement=s,!this._parentElement)throw new Error(`Parent element ${s} not found`);this._galleryElement=this._parentElement.querySelector(`.${e}`),this._moreButton=this._parentElement.querySelector(".load-more"),this._noMoreText=this._parentElement.querySelector(".no-more")}appendImages(e){const s=e.map(r=>this._generateListItem(new p(r)));this._galleryElement.append(...s)}addMoreButton(e,s,r){s>0&&s>e*15?(this._noMoreText.classList.contains("no-more")||this._noMoreText.classList.add("hidden"),this._moreButton.classList.remove("hidden"),this._moreButton.addEventListener("click",r)):(this._noMoreText.classList.remove("hidden"),this._moreButton.classList.contains("hidden")||this._moreButton.classList.add("hidden"),this._moreButton.removeEventListener("click",r))}_generateListItem(e){const s=new _;s.setImage(e);const r=document.createElement("li"),t=document.createElement("a");return t.href=e.imageURL,t.append(s.render()),t.append(this._generateDescription(e)),r.appendChild(t),r}_generateDescription(e){const s=["Likes","Views","Comments","Downloads"],r=document.createElement("table"),t=document.createElement("tr");s.forEach(l=>{const n=document.createElement("th");n.textContent=l,t.appendChild(n)}),r.appendChild(t);const i=document.createElement("tr");return[e.likes,e.views,e.comments,e.downloads].forEach(l=>{const n=document.createElement("td");n.textContent=`${l}`,i.appendChild(n)}),r.appendChild(i),r}clear(){this._galleryElement.innerHTML=""}}class f{constructor(){this._searchForm=document.querySelector("form.search-form"),this._galleryElement=document.querySelector(".gallery"),this._galleryRenderer=new y("gallery",this._galleryElement),this._pixabayApi=new g("49652038-e061cdaf0adfcf3d7bc5fddbb"),this._lightbox=new m("div.gallery ul.gallery li a",{captionsData:"alt",captionDelay:250}),this._page=1,this._loader=document.querySelector(".loader"),this._query=null}async init(){this._searchForm.addEventListener("submit",async e=>{e.preventDefault();const s=e.target.querySelector('input[name="searchQuery"]').value;if(!s){h.error({message:"Please enter a search term."});return}this._query=s,this._resetPaging(),this._searchForm.reset(),this._galleryRenderer.clear(),await this._onSearch()})}_resetPaging(){this._page=1}async _onSearch(){this._toggleLoader();const e=await this._pixabayApi.fetchImages(this._query,this._page);if(this._toggleLoader(),!e.hits||!e.hits.length){h.show({color:"#EF4040",icon:"icon-close",title:"❌",message:"Sorry, there are no images matching your search query. Please try again!"});return}this._galleryRenderer.appendImages(e.hits),this._galleryRenderer.addMoreButton(this._page,e.totalHits,this._loadMore.bind(this)),this._lightbox.refresh()}_scrollByOneRow(){const e=document.querySelector("ul.gallery li");if(e){const s=e.offsetHeight+e.offsetHeight;window.scrollBy({top:s,behavior:"smooth"})}}async _loadMore(e){e.preventDefault(),this._page++,await this._onSearch(this._query),this._scrollByOneRow()}_toggleLoader(){this._loader.classList.toggle("show")}}const w=new f;w.init().catch(o=>{console.error(o)});
//# sourceMappingURL=index.js.map
